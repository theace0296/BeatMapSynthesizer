"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
// All of the Node.js APIs are available in the preload process.
// It has the same sandbox as a Chrome extension.
const electron_1 = require("electron");
const __beatMapArgs_1 = __importDefault(require("./__beatMapArgs"));
let args = new __beatMapArgs_1.default();
let selectedDirs = [];
class operationType {
    static directory = 0;
    static files = 1;
}
var currentOperationType = operationType.files;
function parseFileList() {
    selectedDirs.length = 0;
    const fileListElement = document.getElementById('filelist');
    let matches = fileListElement.value.match(/^(\b|")(.+)(\b|")$/gm);
    if (matches) {
        for (let match of matches) {
            // Remove any quotation marks
            let normalizedMatch = match.replace(/"/g, '');
            // Append filename to varaible
            selectedDirs.push(normalizedMatch);
            // Create the list item:
            let item = document.createElement('li');
            // Set its contents:
            item.appendChild(document.createTextNode(normalizedMatch));
            // Add it to the list:
            document.getElementById('dirsfilesList')?.appendChild(item);
        }
    }
}
function resetTaskLog() {
    const taskLogDiv = document.getElementById('taskLogDiv');
    if (taskLogDiv && taskLogDiv.innerHTML !== '') {
        taskLogDiv.innerHTML = '';
    }
    let element = document.createElement('pre');
    element.classList.add('prettyprint');
    element.classList.add('mvl');
    element.id = 'taskLog_MAIN';
    taskLogDiv?.appendChild(element);
}
electron_1.remote.getCurrentWindow().webContents.once('dom-ready', () => {
    document.getElementById('selectFilesButton')?.addEventListener('click', () => {
        if (document.getElementById('dirsfilesList')?.innerHTML !== '') {
            document.getElementById('dirsfilesList').innerHTML = '';
        }
        currentOperationType = operationType.files;
        electron_1.ipcRenderer.send('__selectFiles__');
    });
    document.getElementById('selectDirectoryButton')?.addEventListener('click', () => {
        if (document.getElementById('dirsfilesList')?.innerHTML !== '') {
            document.getElementById('dirsfilesList').innerHTML = '';
        }
        currentOperationType = operationType.directory;
        electron_1.ipcRenderer.send('__selectDirectory__');
    });
    document.getElementById('selectFileListButton')?.addEventListener('click', () => {
        if (document.getElementById('dirsfilesList')?.innerHTML !== '') {
            document.getElementById('dirsfilesList').innerHTML = '';
        }
        currentOperationType = operationType.directory;
        document.getElementById('filelist')?.classList.remove('hidden');
        parseFileList();
    });
    document.getElementById('filelist')?.addEventListener('change', parseFileList);
    document.getElementById('chooseOutputDirButton')?.addEventListener('click', () => {
        if (document.getElementById('outputDirList')?.innerHTML !== '') {
            document.getElementById('outputDirList').innerHTML = '';
        }
        electron_1.ipcRenderer.send('__selectOutDirectory__');
    });
    document.getElementById('difficultylist')?.addEventListener('change', () => {
        args.difficulty = document.getElementById('difficultylist').value.toString();
    });
    document.getElementById('modellist')?.addEventListener('change', () => {
        args.model = document.getElementById('modellist').value.toString();
        if (args.model.includes('HMM'))
            document.getElementById('dataSource')?.classList.remove('hidden');
        else
            document.getElementById('dataSource')?.classList.add('hidden');
    });
    document.getElementById('environmentlist')?.addEventListener('change', () => {
        args.environment = document.getElementById('environmentlist').value.toString();
    });
    document.getElementById('generateBeatMapButton')?.addEventListener('click', () => {
        resetTaskLog();
        args.version = parseInt(document.getElementById('datalist').value, 10);
        args.lightsIntensity = parseInt(document.getElementById('lightsIntensityInput').value, 10);
        args.zipFiles = document.getElementById('zipFilesLabel')?.classList.contains('checked') ? 1 : 0;
        electron_1.ipcRenderer.send('__generateBeatMap__', currentOperationType, selectedDirs, args);
    });
    document.getElementById('cancelButton')?.addEventListener('click', () => {
        resetTaskLog();
        electron_1.ipcRenderer.send('__cancelOperation__');
    });
    electron_1.ipcRenderer.send('__ready__');
});
electron_1.ipcRenderer.on('console-log', (_event, message) => console.log(message));
electron_1.ipcRenderer.on('console-error', (_event, message) => console.error(message));
electron_1.ipcRenderer.on('task-progress', (_event, value, maxValue) => {
    if (value === 0) {
        document.getElementById('taskProgressBar').innerHTML = `0%`;
        document.getElementById('taskProgressBar').setAttribute('style', `width: 0%;`);
    }
    else if (value === -1) {
        document.getElementById('taskProgressBar').innerHTML = `100%`;
        document.getElementById('taskProgressBar').setAttribute('style', `width: 100%;`);
    }
    else if (value / maxValue <= 0.1) {
        document.getElementById('taskProgressBar').innerHTML = `${((value / maxValue) * 100).toFixed(0)}%`;
        document.getElementById('taskProgressBar').setAttribute('style', `width: 10%;`);
    }
    else {
        document.getElementById('taskProgressBar').innerHTML = `${((value / maxValue) * 100).toFixed(0)}%`;
        document.getElementById('taskProgressBar').setAttribute('style', `width: ${(value / maxValue) * 100}%;`);
    }
});
electron_1.ipcRenderer.on('task-log-append-message', (_event, message, group = 'MAIN') => {
    const id = `taskLog_${group}`;
    let element = document.getElementById(id);
    if (!element) {
        element = document.createElement('pre');
        element.classList.add('prettyprint');
        element.classList.add('mvl');
        element.id = id;
        element.appendChild(document.createTextNode(message + '\n'));
        document.getElementById('taskLogDiv')?.appendChild(element);
    }
    else {
        element.appendChild(document.createTextNode(message + '\n'));
    }
});
electron_1.ipcRenderer.on('selectFilesDirs-finished', (_event, param) => {
    selectedDirs.length = 0;
    for (let value of param) {
        // Append filename to varaible
        selectedDirs.push(value);
        // Create the list item and set its contents
        let item = document.createElement('li');
        item.appendChild(document.createTextNode(value));
        // Add it to the list:
        document.getElementById('dirsfilesList')?.appendChild(item);
    }
});
electron_1.ipcRenderer.on('selectOutDirectory-finished', (_event, param) => {
    // Append filename to varaible
    args.outDir = param;
    // Create the list item and set its contents
    let item = document.createElement('li').appendChild(document.createTextNode(param));
    // Add it to the list:
    document.getElementById('outputDirList')?.appendChild(item);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVuZGVyZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvcmVuZGVyZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxnRUFBZ0U7QUFDaEUsaURBQWlEO0FBQ2pELHVDQUErQztBQUMvQyxvRUFBNEM7QUFFNUMsSUFBSSxJQUFJLEdBQWtCLElBQUksdUJBQWEsRUFBRSxDQUFDO0FBRTlDLElBQUksWUFBWSxHQUFhLEVBQUUsQ0FBQztBQUVoQyxNQUFNLGFBQWE7SUFDakIsTUFBTSxDQUFDLFNBQVMsR0FBVyxDQUFDLENBQUM7SUFDN0IsTUFBTSxDQUFDLEtBQUssR0FBVyxDQUFDLENBQUM7O0FBRzNCLElBQUksb0JBQW9CLEdBQVcsYUFBYSxDQUFDLEtBQUssQ0FBQztBQUV2RCxTQUFTLGFBQWE7SUFDcEIsWUFBWSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUM7SUFDeEIsTUFBTSxlQUFlLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQXdCLENBQUM7SUFDbkYsSUFBSSxPQUFPLEdBQUcsZUFBZSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsc0JBQXNCLENBQUMsQ0FBQztJQUNsRSxJQUFJLE9BQU8sRUFBRTtRQUNYLEtBQUssSUFBSSxLQUFLLElBQUksT0FBTyxFQUFFO1lBQ3pCLDZCQUE2QjtZQUM3QixJQUFJLGVBQWUsR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsQ0FBQztZQUM5Qyw4QkFBOEI7WUFDOUIsWUFBWSxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUNuQyx3QkFBd0I7WUFDeEIsSUFBSSxJQUFJLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUN4QyxvQkFBb0I7WUFDcEIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsY0FBYyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUM7WUFDM0Qsc0JBQXNCO1lB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UUFDOUIsWUFBWSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUN6Qiw0Q0FBNEM7UUFDNUMsSUFBSSxJQUFJLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN4QyxJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztRQUNqRCxzQkFBc0I7UUFDdEIsUUFBUSxDQUFDLGNBQWMsQ0FBQyxlQUFlLENBQUMsRUFBRSxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUM7S0FDN0Q7QUFDSCxDQUFDLENBQUMsQ0FBQztBQUVILHNCQUFXLENBQUMsRUFBRSxDQUFDLDZCQUE2QixFQUFFLENBQUMsTUFBTSxFQUFFLEtBQWEsRUFBRSxFQUFFO0lBQ3RFLDhCQUE4QjtJQUM5QixJQUFJLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQztJQUNwQiw0Q0FBNEM7SUFDNUMsSUFBSSxJQUFJLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBQ3BGLHNCQUFzQjtJQUN0QixRQUFRLENBQUMsY0FBYyxDQUFDLGVBQWUsQ0FBQyxFQUFFLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUM5RCxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIEFsbCBvZiB0aGUgTm9kZS5qcyBBUElzIGFyZSBhdmFpbGFibGUgaW4gdGhlIHByZWxvYWQgcHJvY2Vzcy5cbi8vIEl0IGhhcyB0aGUgc2FtZSBzYW5kYm94IGFzIGEgQ2hyb21lIGV4dGVuc2lvbi5cbmltcG9ydCB7IGlwY1JlbmRlcmVyLCByZW1vdGUgfSBmcm9tICdlbGVjdHJvbic7XG5pbXBvcnQgX19iZWF0TWFwQXJncyBmcm9tICcuL19fYmVhdE1hcEFyZ3MnO1xuXG5sZXQgYXJnczogX19iZWF0TWFwQXJncyA9IG5ldyBfX2JlYXRNYXBBcmdzKCk7XG5cbmxldCBzZWxlY3RlZERpcnM6IHN0cmluZ1tdID0gW107XG5cbmNsYXNzIG9wZXJhdGlvblR5cGUge1xuICBzdGF0aWMgZGlyZWN0b3J5OiBudW1iZXIgPSAwO1xuICBzdGF0aWMgZmlsZXM6IG51bWJlciA9IDE7XG59XG5cbnZhciBjdXJyZW50T3BlcmF0aW9uVHlwZTogbnVtYmVyID0gb3BlcmF0aW9uVHlwZS5maWxlcztcblxuZnVuY3Rpb24gcGFyc2VGaWxlTGlzdCgpIHtcbiAgc2VsZWN0ZWREaXJzLmxlbmd0aCA9IDA7XG4gIGNvbnN0IGZpbGVMaXN0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlbGlzdCcpIGFzIEhUTUxUZXh0QXJlYUVsZW1lbnQ7XG4gIGxldCBtYXRjaGVzID0gZmlsZUxpc3RFbGVtZW50LnZhbHVlLm1hdGNoKC9eKFxcYnxcIikoLispKFxcYnxcIikkL2dtKTtcbiAgaWYgKG1hdGNoZXMpIHtcbiAgICBmb3IgKGxldCBtYXRjaCBvZiBtYXRjaGVzKSB7XG4gICAgICAvLyBSZW1vdmUgYW55IHF1b3RhdGlvbiBtYXJrc1xuICAgICAgbGV0IG5vcm1hbGl6ZWRNYXRjaCA9IG1hdGNoLnJlcGxhY2UoL1wiL2csICcnKTtcbiAgICAgIC8vIEFwcGVuZCBmaWxlbmFtZSB0byB2YXJhaWJsZVxuICAgICAgc2VsZWN0ZWREaXJzLnB1c2gobm9ybWFsaXplZE1hdGNoKTtcbiAgICAgIC8vIENyZWF0ZSB0aGUgbGlzdCBpdGVtOlxuICAgICAgbGV0IGl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICAgICAgLy8gU2V0IGl0cyBjb250ZW50czpcbiAgICAgIGl0ZW0uYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUobm9ybWFsaXplZE1hdGNoKSk7XG4gICAgICAvLyBBZGQgaXQgdG8gdGhlIGxpc3Q6XG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGlyc2ZpbGVzTGlzdCcpPy5hcHBlbmRDaGlsZChpdGVtKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gcmVzZXRUYXNrTG9nKCkge1xuICBjb25zdCB0YXNrTG9nRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2tMb2dEaXYnKTtcbiAgaWYgKHRhc2tMb2dEaXYgJiYgdGFza0xvZ0Rpdi5pbm5lckhUTUwgIT09ICcnKSB7XG4gICAgdGFza0xvZ0Rpdi5pbm5lckhUTUwgPSAnJztcbiAgfVxuICBsZXQgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3ByZScpO1xuICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3ByZXR0eXByaW50Jyk7XG4gIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnbXZsJyk7XG4gIGVsZW1lbnQuaWQgPSAndGFza0xvZ19NQUlOJztcbiAgdGFza0xvZ0Rpdj8uYXBwZW5kQ2hpbGQoZWxlbWVudCk7XG59XG5cbnJlbW90ZS5nZXRDdXJyZW50V2luZG93KCkud2ViQ29udGVudHMub25jZSgnZG9tLXJlYWR5JywgKCkgPT4ge1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VsZWN0RmlsZXNCdXR0b24nKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkaXJzZmlsZXNMaXN0Jyk/LmlubmVySFRNTCAhPT0gJycpIHtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkaXJzZmlsZXNMaXN0JykhLmlubmVySFRNTCA9ICcnO1xuICAgIH1cbiAgICBjdXJyZW50T3BlcmF0aW9uVHlwZSA9IG9wZXJhdGlvblR5cGUuZmlsZXM7XG4gICAgaXBjUmVuZGVyZXIuc2VuZCgnX19zZWxlY3RGaWxlc19fJyk7XG4gIH0pO1xuXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWxlY3REaXJlY3RvcnlCdXR0b24nKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkaXJzZmlsZXNMaXN0Jyk/LmlubmVySFRNTCAhPT0gJycpIHtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkaXJzZmlsZXNMaXN0JykhLmlubmVySFRNTCA9ICcnO1xuICAgIH1cbiAgICBjdXJyZW50T3BlcmF0aW9uVHlwZSA9IG9wZXJhdGlvblR5cGUuZGlyZWN0b3J5O1xuICAgIGlwY1JlbmRlcmVyLnNlbmQoJ19fc2VsZWN0RGlyZWN0b3J5X18nKTtcbiAgfSk7XG5cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlbGVjdEZpbGVMaXN0QnV0dG9uJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGlyc2ZpbGVzTGlzdCcpPy5pbm5lckhUTUwgIT09ICcnKSB7XG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGlyc2ZpbGVzTGlzdCcpIS5pbm5lckhUTUwgPSAnJztcbiAgICB9XG4gICAgY3VycmVudE9wZXJhdGlvblR5cGUgPSBvcGVyYXRpb25UeXBlLmRpcmVjdG9yeTtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZWxpc3QnKT8uY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG4gICAgcGFyc2VGaWxlTGlzdCgpO1xuICB9KTtcblxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZWxpc3QnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgcGFyc2VGaWxlTGlzdCk7XG5cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nob29zZU91dHB1dERpckJ1dHRvbicpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ291dHB1dERpckxpc3QnKT8uaW5uZXJIVE1MICE9PSAnJykge1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ291dHB1dERpckxpc3QnKSEuaW5uZXJIVE1MID0gJyc7XG4gICAgfVxuICAgIGlwY1JlbmRlcmVyLnNlbmQoJ19fc2VsZWN0T3V0RGlyZWN0b3J5X18nKTtcbiAgfSk7XG5cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RpZmZpY3VsdHlsaXN0Jyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHtcbiAgICBhcmdzLmRpZmZpY3VsdHkgPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RpZmZpY3VsdHlsaXN0JykgYXMgSFRNTFNlbGVjdEVsZW1lbnQpLnZhbHVlLnRvU3RyaW5nKCk7XG4gIH0pO1xuXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RlbGxpc3QnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4ge1xuICAgIGFyZ3MubW9kZWwgPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGVsbGlzdCcpIGFzIEhUTUxTZWxlY3RFbGVtZW50KS52YWx1ZS50b1N0cmluZygpO1xuICAgIGlmIChhcmdzLm1vZGVsLmluY2x1ZGVzKCdITU0nKSkgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RhdGFTb3VyY2UnKT8uY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG4gICAgZWxzZSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGF0YVNvdXJjZScpPy5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgfSk7XG5cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Vudmlyb25tZW50bGlzdCcpPy5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB7XG4gICAgYXJncy5lbnZpcm9ubWVudCA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZW52aXJvbm1lbnRsaXN0JykgYXMgSFRNTFNlbGVjdEVsZW1lbnQpLnZhbHVlLnRvU3RyaW5nKCk7XG4gIH0pO1xuXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdnZW5lcmF0ZUJlYXRNYXBCdXR0b24nKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgcmVzZXRUYXNrTG9nKCk7XG4gICAgYXJncy52ZXJzaW9uID0gcGFyc2VJbnQoKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYXRhbGlzdCcpIGFzIEhUTUxTZWxlY3RFbGVtZW50KS52YWx1ZSwgMTApO1xuICAgIGFyZ3MubGlnaHRzSW50ZW5zaXR5ID0gcGFyc2VJbnQoKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaWdodHNJbnRlbnNpdHlJbnB1dCcpIGFzIEhUTUxJbnB1dEVsZW1lbnQpLnZhbHVlLCAxMCk7XG4gICAgYXJncy56aXBGaWxlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6aXBGaWxlc0xhYmVsJyk/LmNsYXNzTGlzdC5jb250YWlucygnY2hlY2tlZCcpID8gMSA6IDA7XG4gICAgaXBjUmVuZGVyZXIuc2VuZCgnX19nZW5lcmF0ZUJlYXRNYXBfXycsIGN1cnJlbnRPcGVyYXRpb25UeXBlLCBzZWxlY3RlZERpcnMsIGFyZ3MpO1xuICB9KTtcblxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FuY2VsQnV0dG9uJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIHJlc2V0VGFza0xvZygpO1xuICAgIGlwY1JlbmRlcmVyLnNlbmQoJ19fY2FuY2VsT3BlcmF0aW9uX18nKTtcbiAgfSk7XG5cbiAgaXBjUmVuZGVyZXIuc2VuZCgnX19yZWFkeV9fJyk7XG59KTtcblxuaXBjUmVuZGVyZXIub24oJ2NvbnNvbGUtbG9nJywgKF9ldmVudCwgbWVzc2FnZTogc3RyaW5nKSA9PiBjb25zb2xlLmxvZyhtZXNzYWdlKSk7XG5cbmlwY1JlbmRlcmVyLm9uKCdjb25zb2xlLWVycm9yJywgKF9ldmVudCwgbWVzc2FnZTogc3RyaW5nKSA9PiBjb25zb2xlLmVycm9yKG1lc3NhZ2UpKTtcblxuaXBjUmVuZGVyZXIub24oJ3Rhc2stcHJvZ3Jlc3MnLCAoX2V2ZW50LCB2YWx1ZTogbnVtYmVyLCBtYXhWYWx1ZTogbnVtYmVyKSA9PiB7XG4gIGlmICh2YWx1ZSA9PT0gMCkge1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YXNrUHJvZ3Jlc3NCYXInKSEuaW5uZXJIVE1MID0gYDAlYDtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFza1Byb2dyZXNzQmFyJykhLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCBgd2lkdGg6IDAlO2ApO1xuICB9IGVsc2UgaWYgKHZhbHVlID09PSAtMSkge1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YXNrUHJvZ3Jlc3NCYXInKSEuaW5uZXJIVE1MID0gYDEwMCVgO1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YXNrUHJvZ3Jlc3NCYXInKSEuc2V0QXR0cmlidXRlKCdzdHlsZScsIGB3aWR0aDogMTAwJTtgKTtcbiAgfSBlbHNlIGlmICh2YWx1ZSAvIG1heFZhbHVlIDw9IDAuMSkge1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YXNrUHJvZ3Jlc3NCYXInKSEuaW5uZXJIVE1MID0gYCR7KCh2YWx1ZSAvIG1heFZhbHVlKSAqIDEwMCkudG9GaXhlZCgwKX0lYDtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFza1Byb2dyZXNzQmFyJykhLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCBgd2lkdGg6IDEwJTtgKTtcbiAgfSBlbHNlIHtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFza1Byb2dyZXNzQmFyJykhLmlubmVySFRNTCA9IGAkeygodmFsdWUgLyBtYXhWYWx1ZSkgKiAxMDApLnRvRml4ZWQoMCl9JWA7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2tQcm9ncmVzc0JhcicpIS5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgYHdpZHRoOiAkeyh2YWx1ZSAvIG1heFZhbHVlKSAqIDEwMH0lO2ApO1xuICB9XG59KTtcblxuaXBjUmVuZGVyZXIub24oJ3Rhc2stbG9nLWFwcGVuZC1tZXNzYWdlJywgKF9ldmVudCwgbWVzc2FnZTogc3RyaW5nLCBncm91cDogc3RyaW5nID0gJ01BSU4nKSA9PiB7XG4gIGNvbnN0IGlkID0gYHRhc2tMb2dfJHtncm91cH1gO1xuICBsZXQgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgaWYgKCFlbGVtZW50KSB7XG4gICAgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3ByZScpO1xuICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgncHJldHR5cHJpbnQnKTtcbiAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoJ212bCcpO1xuICAgIGVsZW1lbnQuaWQgPSBpZDtcbiAgICBlbGVtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKG1lc3NhZ2UgKyAnXFxuJykpO1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YXNrTG9nRGl2Jyk/LmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICB9IGVsc2Uge1xuICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUobWVzc2FnZSArICdcXG4nKSk7XG4gIH1cbn0pO1xuXG5pcGNSZW5kZXJlci5vbignc2VsZWN0RmlsZXNEaXJzLWZpbmlzaGVkJywgKF9ldmVudCwgcGFyYW06IHN0cmluZ1tdKSA9PiB7XG4gIHNlbGVjdGVkRGlycy5sZW5ndGggPSAwO1xuICBmb3IgKGxldCB2YWx1ZSBvZiBwYXJhbSkge1xuICAgIC8vIEFwcGVuZCBmaWxlbmFtZSB0byB2YXJhaWJsZVxuICAgIHNlbGVjdGVkRGlycy5wdXNoKHZhbHVlKTtcbiAgICAvLyBDcmVhdGUgdGhlIGxpc3QgaXRlbSBhbmQgc2V0IGl0cyBjb250ZW50c1xuICAgIGxldCBpdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICBpdGVtLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHZhbHVlKSk7XG4gICAgLy8gQWRkIGl0IHRvIHRoZSBsaXN0OlxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkaXJzZmlsZXNMaXN0Jyk/LmFwcGVuZENoaWxkKGl0ZW0pO1xuICB9XG59KTtcblxuaXBjUmVuZGVyZXIub24oJ3NlbGVjdE91dERpcmVjdG9yeS1maW5pc2hlZCcsIChfZXZlbnQsIHBhcmFtOiBzdHJpbmcpID0+IHtcbiAgLy8gQXBwZW5kIGZpbGVuYW1lIHRvIHZhcmFpYmxlXG4gIGFyZ3Mub3V0RGlyID0gcGFyYW07XG4gIC8vIENyZWF0ZSB0aGUgbGlzdCBpdGVtIGFuZCBzZXQgaXRzIGNvbnRlbnRzXG4gIGxldCBpdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShwYXJhbSkpO1xuICAvLyBBZGQgaXQgdG8gdGhlIGxpc3Q6XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvdXRwdXREaXJMaXN0Jyk/LmFwcGVuZENoaWxkKGl0ZW0pO1xufSk7XG4iXX0=